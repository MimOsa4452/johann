---
phase: 01-foundation
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - index.html
  - vite/config.dev.mjs
  - vite/config.prod.mjs
  - src/main.js
  - src/constants.js
  - src/scenes/BootScene.js
  - src/scenes/PreloadScene.js
  - src/scenes/MenuScene.js
  - src/scenes/GameScene.js
  - src/scenes/HUDScene.js
  - src/scenes/ResultScene.js
  - public/assets/atlases/.gitkeep
  - public/assets/audio/.gitkeep
  - public/assets/backgrounds/.gitkeep
autonomous: true

must_haves:
  truths:
    - "npm run dev starts a Vite dev server on localhost without errors"
    - "Game boots in browser and shows a menu screen (no blank canvas, no console errors)"
    - "Clicking Play on MenuScene transitions to GameScene without errors"
    - "GameScene transitions to ResultScene and ResultScene returns to MenuScene"
    - "All six scenes (Boot, Preload, Menu, Game, HUD, Result) are registered in Phaser.Game config"
  artifacts:
    - path: "src/main.js"
      provides: "Phaser.Game config with all 6 scenes, type: Phaser.AUTO, 1280x720, Scale.FIT"
      contains: "Phaser.Game"
    - path: "src/constants.js"
      provides: "DEPTH and SCENE_KEYS constants"
      exports: ["DEPTH", "SCENE_KEYS"]
    - path: "src/scenes/BootScene.js"
      provides: "Boot scene — sets pixel art renderer flag, transitions to PreloadScene"
      exports: ["BootScene"]
    - path: "src/scenes/PreloadScene.js"
      provides: "Asset loading with progress bar, transitions to MenuScene on complete"
      exports: ["PreloadScene"]
    - path: "src/scenes/MenuScene.js"
      provides: "Title screen with Play button/key; transitions to GameScene"
      exports: ["MenuScene"]
    - path: "src/scenes/GameScene.js"
      provides: "Shell game scene — empty create(), transitions to ResultScene on key press"
      exports: ["GameScene"]
    - path: "src/scenes/HUDScene.js"
      provides: "Parallel HUD scene shell — empty create()"
      exports: ["HUDScene"]
    - path: "src/scenes/ResultScene.js"
      provides: "Results screen — shows placeholder text, returns to MenuScene"
      exports: ["ResultScene"]
  key_links:
    - from: "src/main.js"
      to: "all scene files"
      via: "ES module import"
      pattern: "import.*Scene.*from"
    - from: "src/scenes/BootScene.js"
      to: "PreloadScene"
      via: "this.scene.start(SCENE_KEYS.PRELOAD)"
      pattern: "scene.start"
    - from: "src/scenes/PreloadScene.js"
      to: "MenuScene"
      via: "this.load.on('complete', ...) → this.scene.start(SCENE_KEYS.MENU)"
      pattern: "load.*complete"
    - from: "src/scenes/MenuScene.js"
      to: "GameScene"
      via: "button/key input → this.scene.start(SCENE_KEYS.GAME)"
      pattern: "scene.start.*GAME"
    - from: "src/scenes/GameScene.js"
      to: "ResultScene"
      via: "this.scene.start(SCENE_KEYS.RESULT, { score, roundNum })"
      pattern: "scene.start.*RESULT"
    - from: "src/scenes/ResultScene.js"
      to: "MenuScene"
      via: "key press → this.scene.start(SCENE_KEYS.MENU)"
      pattern: "scene.start.*MENU"
---

<objective>
Bootstrap the Franna project from zero: initialize the Vite + Phaser 3 project, define the complete scene graph, write all scene shells, and establish the constants module.

Purpose: Every subsequent plan and phase builds on this scaffold. Scene keys, DEPTH constants, and the boot sequence must be correct from the first commit.
Output: A running Vite dev server with Phaser 3 loaded, all six scenes registered and navigable, DEPTH and SCENE_KEYS constants in place, and the public asset directory structure ready for Phase 2 art.
</objective>

<execution_context>
@/home/hrmnn/.claude/get-shit-done/workflows/execute-plan.md
@/home/hrmnn/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Phaser 3 + Vite project and constants</name>
  <files>package.json, index.html, vite/config.dev.mjs, vite/config.prod.mjs, src/main.js, src/constants.js, public/assets/atlases/.gitkeep, public/assets/audio/.gitkeep, public/assets/backgrounds/.gitkeep</files>
  <action>
    Initialize from the official Phaser Vite template. Run in the project root (/home/hrmnn/franna — already a git repo):

    ```bash
    # Install Phaser 3.90.0 and Vite 6 directly (repo already exists, skip git init)
    npm init -y
    npm install phaser@3.90.0
    npm install --save-dev vite@6.3.1
    ```

    Create `index.html` in the project root:
    - Standard HTML5 boilerplate with `<script type="module" src="/src/main.js"></script>`
    - No extra markup needed — Phaser mounts its canvas into `document.body` by default
    - Set `<title>Franna</title>`

    Create `vite/config.dev.mjs`:
    ```javascript
    import { defineConfig } from 'vite';
    export default defineConfig({
      base: './',
      server: { host: true, port: 3000 }
    });
    ```

    Create `vite/config.prod.mjs`:
    ```javascript
    import { defineConfig } from 'vite';
    export default defineConfig({
      base: './',
      build: { outDir: 'dist' }
    });
    ```

    Update `package.json` scripts:
    ```json
    "scripts": {
      "dev": "vite --config vite/config.dev.mjs",
      "build": "vite build --config vite/config.prod.mjs",
      "preview": "vite preview --config vite/config.prod.mjs"
    }
    ```

    Create `src/constants.js` with the DEPTH z-order map and SCENE_KEYS string constants. Use EXACTLY these values (required by later plans):
    ```javascript
    export const DEPTH = {
      SKY:           0,
      HILLS:        10,
      MIDGROUND:    20,
      ANIMALS:      30,
      FOREGROUND:   40,
      SCOPE_DARK:   50,   // semi-transparent scope vignette overlay
      SCOPE_WINDOW: 60,   // circular lens cutout
      CROSSHAIR:    70,
      HUD:         100,
    };

    export const SCENE_KEYS = {
      BOOT:    'BootScene',
      PRELOAD: 'PreloadScene',
      MENU:    'MenuScene',
      GAME:    'GameScene',
      HUD:     'HUDScene',
      RESULT:  'ResultScene',
    };
    ```

    Create `src/main.js`:
    ```javascript
    import Phaser from 'phaser';
    import { BootScene }    from './scenes/BootScene.js';
    import { PreloadScene } from './scenes/PreloadScene.js';
    import { MenuScene }    from './scenes/MenuScene.js';
    import { GameScene }    from './scenes/GameScene.js';
    import { HUDScene }     from './scenes/HUDScene.js';
    import { ResultScene }  from './scenes/ResultScene.js';

    export default new Phaser.Game({
      type: Phaser.AUTO,        // WebGL with Canvas fallback — never use Phaser.WEBGL directly
      width: 1280,
      height: 720,
      backgroundColor: '#000000',
      parent: document.body,
      scene: [BootScene, PreloadScene, MenuScene, GameScene, HUDScene, ResultScene],
      scale: {
        mode: Phaser.Scale.FIT,
        autoCenter: Phaser.Scale.CENTER_BOTH,
      },
    });
    ```

    Note: Scene array order matters — last registered scene renders on top. HUDScene must appear after GameScene in the array so it renders above the game world when launched in parallel.

    Create public asset directory placeholders:
    ```
    public/assets/atlases/.gitkeep
    public/assets/audio/.gitkeep
    public/assets/backgrounds/.gitkeep
    ```
  </action>
  <verify>
    Run `npm run dev` — Vite dev server should start without errors. Opening localhost:3000 will show a blank/error screen (scenes not written yet), but the server must start cleanly.
    Check: no missing module errors in terminal output.
  </verify>
  <done>
    `npm run dev` starts successfully. `package.json` has phaser@3.90.0 and vite@6.3.1 in dependencies. `src/constants.js` exports DEPTH and SCENE_KEYS. `src/main.js` imports all six scene classes and constructs a Phaser.Game.
  </done>
</task>

<task type="auto">
  <name>Task 2: Write all six scene shells with working navigation</name>
  <files>src/scenes/BootScene.js, src/scenes/PreloadScene.js, src/scenes/MenuScene.js, src/scenes/GameScene.js, src/scenes/HUDScene.js, src/scenes/ResultScene.js</files>
  <action>
    Write each scene as a named export extending `Phaser.Scene`. Every scene registers a `shutdown` cleanup handler. Use `SCENE_KEYS` from `constants.js` for all `this.scene.start()` calls — never hardcode string keys.

    **BootScene.js** — Runs synchronously (no assets), configures renderer, transitions immediately:
    ```javascript
    import { SCENE_KEYS } from '../constants.js';
    export class BootScene extends Phaser.Scene {
      constructor() { super({ key: SCENE_KEYS.BOOT }); }
      create() {
        // BootScene has nothing to load — go straight to PreloadScene
        this.scene.start(SCENE_KEYS.PRELOAD);
      }
    }
    ```

    **PreloadScene.js** — Loads all assets, shows progress bar, transitions to MenuScene on complete:
    ```javascript
    import { SCENE_KEYS } from '../constants.js';
    export class PreloadScene extends Phaser.Scene {
      constructor() { super({ key: SCENE_KEYS.PRELOAD }); }
      preload() {
        const { width, height } = this.scale;

        // Progress bar background
        const barBg = this.add.rectangle(width / 2, height / 2, 880, 24, 0x333333);
        const bar   = this.add.rectangle(width / 2 - 440, height / 2, 0, 24, 0xffffff).setOrigin(0, 0.5);
        this.add.text(width / 2, height / 2 - 40, 'Loading...', { fontSize: '20px', color: '#ffffff' }).setOrigin(0.5);

        this.load.on('progress', (p) => { bar.width = 880 * p; });

        // Phase 1: no real assets yet — placeholder load path
        // Phase 2 will call: this.load.atlas('animals', ...) etc.
        this.load.setPath('assets/');
      }
      create() {
        // Fires after all loads complete (or immediately if nothing to load)
        this.scene.start(SCENE_KEYS.MENU);
      }
    }
    ```

    **MenuScene.js** — Title text, "Press SPACE to Play" instruction, Space key transitions to GameScene:
    ```javascript
    import { SCENE_KEYS } from '../constants.js';
    export class MenuScene extends Phaser.Scene {
      constructor() { super({ key: SCENE_KEYS.MENU }); }
      create() {
        const { width, height } = this.scale;
        this.add.text(width / 2, height / 2 - 80, 'FRANNA', { fontSize: '72px', color: '#ffffff', fontStyle: 'bold' }).setOrigin(0.5);
        this.add.text(width / 2, height / 2 + 20, 'Press SPACE to Play', { fontSize: '28px', color: '#cccccc' }).setOrigin(0.5);

        const spaceKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);
        spaceKey.once('down', () => { this.scene.start(SCENE_KEYS.GAME); });

        this.events.once('shutdown', () => { spaceKey.destroy(); });
      }
    }
    ```

    **GameScene.js** — Empty shell. Launches HUDScene in parallel. Press R to transition to ResultScene (temporary dev shortcut removed in Phase 2):
    ```javascript
    import { SCENE_KEYS } from '../constants.js';
    export class GameScene extends Phaser.Scene {
      constructor() { super({ key: SCENE_KEYS.GAME }); }
      create() {
        const { width, height } = this.scale;

        // Launch HUDScene as a parallel scene (runs on top of GameScene)
        this.scene.launch(SCENE_KEYS.HUD);

        // Placeholder text
        this.add.text(width / 2, height / 2, 'Game Scene\nPress R to see Results', {
          fontSize: '28px', color: '#ffffff', align: 'center'
        }).setOrigin(0.5);

        const rKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.R);
        rKey.once('down', () => {
          this.scene.stop(SCENE_KEYS.HUD);
          this.scene.start(SCENE_KEYS.RESULT, { score: 0, roundNum: 1 });
        });

        this.events.once('shutdown', () => {
          rKey.destroy();
          // HUDScene is stopped via scene.stop() before scene.start(RESULT) above
        });
      }
    }
    ```

    **HUDScene.js** — Parallel overlay scene shell. Displays placeholder HUD text. Listens for GameScene events:
    ```javascript
    import { SCENE_KEYS } from '../constants.js';
    export class HUDScene extends Phaser.Scene {
      constructor() { super({ key: SCENE_KEYS.HUD }); }
      create() {
        // HUDScene renders on top of GameScene (registered after it in main.js)
        this.add.text(16, 16, 'HUD', { fontSize: '18px', color: '#ffff00' });

        // Cross-scene event wiring will be added in Phase 2 (round timer, score)
        const gameScene = this.scene.get(SCENE_KEYS.GAME);
        this.events.once('shutdown', () => {
          // Remove any gameScene listeners here in Phase 2
        });
      }
    }
    ```

    **ResultScene.js** — Shows final score from scene data. Space returns to MenuScene:
    ```javascript
    import { SCENE_KEYS } from '../constants.js';
    export class ResultScene extends Phaser.Scene {
      constructor() { super({ key: SCENE_KEYS.RESULT }); }
      init(data) {
        this.finalScore = data.score ?? 0;
        this.roundNum   = data.roundNum ?? 1;
      }
      create() {
        const { width, height } = this.scale;
        this.add.text(width / 2, height / 2 - 60, 'Round Complete!', { fontSize: '48px', color: '#ffffff' }).setOrigin(0.5);
        this.add.text(width / 2, height / 2 + 10, `Score: ${this.finalScore}`, { fontSize: '36px', color: '#ffdd00' }).setOrigin(0.5);
        this.add.text(width / 2, height / 2 + 70, 'Press SPACE for Menu', { fontSize: '22px', color: '#aaaaaa' }).setOrigin(0.5);

        const spaceKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);
        spaceKey.once('down', () => { this.scene.start(SCENE_KEYS.MENU); });

        this.events.once('shutdown', () => { spaceKey.destroy(); });
      }
    }
    ```
  </action>
  <verify>
    Open localhost:3000 in browser. Sequence:
    1. Game loads and shows MenuScene with "FRANNA" title — no console errors
    2. Press Space → transitions to GameScene, "Game Scene" placeholder text visible, HUD "HUD" text visible in yellow top-left
    3. Press R → transitions to ResultScene, "Round Complete! Score: 0" visible
    4. Press Space → returns to MenuScene
    5. Check browser console — zero errors, zero warnings about missing assets
  </verify>
  <done>
    All six scenes exist with named exports. Boot → Preload → Menu → Game (+HUD parallel) → Result → Menu navigation works via keyboard. No console errors in any transition.
  </done>
</task>

</tasks>

<verification>
Full navigation flow test: Boot → Preload (instant, no assets) → Menu → GameScene (HUDScene visible in parallel) → ResultScene → MenuScene.
Run `npm run build` — production build must complete without errors.
</verification>

<success_criteria>
- `npm run dev` starts cleanly on localhost:3000
- All 6 scenes navigate correctly via keyboard with no console errors
- `src/constants.js` exports DEPTH (9 depth levels) and SCENE_KEYS (6 keys)
- HUDScene launches as a parallel scene (visible simultaneously with GameScene)
- `npm run build` succeeds (production bundle created in dist/)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md` using the summary template.
</output>
